(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{VFTF:function(n,l,u){"use strict";var o=u("mrSG"),t=function(){return function(n,l,u,o,t,i,e,b,r,c){this.id=n,this.placeId=l,this.userId=u,this.placeTitle=o,this.placeImage=t,this.firstName=i,this.lastName=e,this.guestNumber=b,this.bookedFrom=r,this.bookedTo=c}}(),i=u("26FU"),e=u("qXBG"),b=u("t9fZ"),r=u("67Y/"),c=u("15JJ"),s=u("xMyE"),a=u("CcnG"),p=u("t/Na");u.d(l,"a",(function(){return f}));var f=function(){function n(n,l){this.authService=n,this.http=l,this._bookings=new i.a([])}return Object.defineProperty(n.prototype,"bookings",{get:function(){return this._bookings.asObservable()},enumerable:!0,configurable:!0}),n.prototype.getBooking=function(n){return this.bookings.pipe(Object(b.a)(1),Object(r.a)((function(l){return o.__assign({},l.find((function(l){return l.id===n})))})))},n.prototype.fetchBookings=function(){var n,l=this;return this.authService.userId.pipe(Object(b.a)(1),Object(c.a)((function(u){if(!u)throw new Error("User not found!");return n=u,l.authService.token})),Object(b.a)(1),Object(c.a)((function(u){return l.http.get('https://ionic-angular-course-b1b7f.firebaseio.com/bookings.json?orderBy="userId"&equalTo="'+n+'"&auth='+u)})),Object(r.a)((function(n){var l=[];for(var u in n)if(n.hasOwnProperty(u)){var o=n[u];l.push(new t(u,o.placeId,o.userId,o.placeTitle,o.placeImage,o.firstName,o.lastName,o.guestNumber,new Date(o.bookedFrom),new Date(o.bookedTo)))}return l})),Object(s.a)((function(n){console.log("bookings: ",n),l._bookings.next(n)})))},n.prototype.addBooking=function(n,l,u,i,e,r,a,p){var f,g,d,h=this;return this.authService.userId.pipe(Object(b.a)(1),Object(c.a)((function(n){if(!n)throw new Error("No user id found!");return d=n,h.authService.token})),Object(b.a)(1),Object(c.a)((function(b){return g=new t(Math.random().toString(),n,d,l,u,i,e,r,a,p),h.http.post("https://ionic-angular-course-b1b7f.firebaseio.com/bookings.json?auth="+b,o.__assign({},g,{id:null}))})),Object(c.a)((function(n){return f=n.name,h.bookings})),Object(b.a)(1),Object(s.a)((function(n){g.id=f,h._bookings.next(n.concat(g))})))},n.prototype.cancelBooking=function(n){var l=this;return this.authService.token.pipe(Object(b.a)(1),Object(c.a)((function(u){return l.http.delete("https://ionic-angular-course-b1b7f.firebaseio.com/bookings/"+n+".json?auth="+u)})),Object(c.a)((function(){return l.bookings})),Object(b.a)(1),Object(s.a)((function(u){l._bookings.next(u.filter((function(l){return l.id!==n})))})))},n.ngInjectableDef=a.Yb({factory:function(){return new n(a.Zb(e.a),a.Zb(p.c))},token:n,providedIn:"root"}),n}()},ZpdU:function(n,l,u){"use strict";u.r(l);var o=u("CcnG"),t=function(){return function(){}}(),i=u("pMnS"),e=u("oBZk"),b=u("ZZ/e"),r=u("Ip0R"),c=u("VFTF"),s=function(){function n(n,l){this.bookingService=n,this.loadingCtrl=l,this.isLoading=!1}return n.prototype.ngOnInit=function(){var n=this;this.bookingSub=this.bookingService.bookings.subscribe((function(l){n.loadedBookings=l}))},n.prototype.ionViewWillEnter=function(){var n=this;this.isLoading=!0,this.bookingService.fetchBookings().subscribe((function(){n.isLoading=!1}))},n.prototype.onCancelBooking=function(n,l){var u=this;l.close(),console.log("cancel booking with id:",n),this.loadingCtrl.create({message:"Cancelling.."}).then((function(l){l.present(),u.bookingService.cancelBooking(n).subscribe((function(){return l.dismiss()}))}))},n.prototype.ngOnDestroy=function(){this.bookingSub&&this.bookingSub.unsubscribe()},n}(),a=o.zb({encapsulation:0,styles:[[""]],data:{}});function p(n){return o.Vb(0,[(n()(),o.Bb(0,0,null,null,3,"ion-col",[["class","ion-text-center"],["offset-md","2"],["size-md","8"]],null,null,null,e.ab,e.k)),o.Ab(1,49152,null,0,b.t,[o.j,o.p,o.F],null,null),(n()(),o.Bb(2,0,null,0,1,"ion-spinner",[["color","primary"]],null,null,null,e.wb,e.G)),o.Ab(3,49152,null,0,b.sb,[o.j,o.p,o.F],{color:[0,"color"]},null)],(function(n,l){n(l,3,0,"primary")}),null)}function f(n){return o.Vb(0,[(n()(),o.Bb(0,0,null,null,3,"ion-col",[["class","ion-text-center"],["offset-md","2"],["size-md","8"]],null,null,null,e.ab,e.k)),o.Ab(1,49152,null,0,b.t,[o.j,o.p,o.F],null,null),(n()(),o.Bb(2,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),o.Tb(-1,null,[" No bookings found !!!"]))],null,null)}function g(n){return o.Vb(0,[(n()(),o.Bb(0,0,null,null,19,"ion-item-sliding",[],null,null,null,e.kb,e.v)),o.Ab(1,49152,[["slidingBooking",4]],0,b.M,[o.j,o.p,o.F],null,null),(n()(),o.Bb(2,0,null,0,11,"ion-item",[],null,null,null,e.lb,e.s)),o.Ab(3,49152,null,0,b.H,[o.j,o.p,o.F],null,null),(n()(),o.Bb(4,0,null,0,3,"ion-avatar",[["slot","start"]],null,null,null,e.R,e.b)),o.Ab(5,49152,null,0,b.f,[o.j,o.p,o.F],null,null),(n()(),o.Bb(6,0,null,0,1,"ion-img",[],null,null,null,e.gb,e.q)),o.Ab(7,49152,null,0,b.D,[o.j,o.p,o.F],{src:[0,"src"]},null),(n()(),o.Bb(8,0,null,0,5,"ion-label",[],null,null,null,e.mb,e.w)),o.Ab(9,49152,null,0,b.N,[o.j,o.p,o.F],null,null),(n()(),o.Bb(10,0,null,0,1,"h5",[],null,null,null,null,null)),(n()(),o.Tb(11,null,[" ",""])),(n()(),o.Bb(12,0,null,0,1,"p",[],null,null,null,null,null)),(n()(),o.Tb(13,null,[" Guests: ",""])),(n()(),o.Bb(14,0,null,0,5,"ion-item-options",[],null,null,null,e.jb,e.u)),o.Ab(15,49152,null,0,b.L,[o.j,o.p,o.F],null,null),(n()(),o.Bb(16,0,null,0,3,"ion-item-option",[["color","danger"]],null,[[null,"click"]],(function(n,l,u){var t=!0;return"click"===l&&(t=!1!==n.component.onCancelBooking(n.context.$implicit.id,o.Mb(n,1))&&t),t}),e.ib,e.t)),o.Ab(17,49152,null,0,b.K,[o.j,o.p,o.F],{color:[0,"color"]},null),(n()(),o.Bb(18,0,null,0,1,"ion-icon",[["name","trash"],["slot","icon-only"]],null,null,null,e.fb,e.p)),o.Ab(19,49152,null,0,b.C,[o.j,o.p,o.F],{name:[0,"name"]},null)],(function(n,l){n(l,7,0,l.context.$implicit.placeImage),n(l,17,0,"danger"),n(l,19,0,"trash")}),(function(n,l){n(l,11,0,l.context.$implicit.placeTitle),n(l,13,0,l.context.$implicit.guestNumber)}))}function d(n){return o.Vb(0,[(n()(),o.Bb(0,0,null,null,5,"ion-col",[["offset-md","2"],["size-md","8"]],null,null,null,e.ab,e.k)),o.Ab(1,49152,null,0,b.t,[o.j,o.p,o.F],null,null),(n()(),o.Bb(2,0,null,0,3,"ion-list",[],null,null,null,e.nb,e.x)),o.Ab(3,49152,null,0,b.O,[o.j,o.p,o.F],null,null),(n()(),o.qb(16777216,null,0,1,null,g)),o.Ab(5,278528,null,0,r.j,[o.W,o.S,o.x],{ngForOf:[0,"ngForOf"]},null)],(function(n,l){n(l,5,0,l.component.loadedBookings)}),null)}function h(n){return o.Vb(0,[(n()(),o.Bb(0,0,null,null,10,"ion-header",[],null,null,null,e.eb,e.o)),o.Ab(1,49152,null,0,b.B,[o.j,o.p,o.F],null,null),(n()(),o.Bb(2,0,null,0,8,"ion-toolbar",[],null,null,null,e.Eb,e.O)),o.Ab(3,49152,null,0,b.Cb,[o.j,o.p,o.F],null,null),(n()(),o.Bb(4,0,null,0,3,"ion-buttons",[],null,null,null,e.U,e.e)),o.Ab(5,49152,null,0,b.l,[o.j,o.p,o.F],null,null),(n()(),o.Bb(6,0,null,0,1,"ion-menu-button",[["menu","m1"]],null,null,null,e.ob,e.z)),o.Ab(7,49152,null,0,b.R,[o.j,o.p,o.F],{menu:[0,"menu"]},null),(n()(),o.Bb(8,0,null,0,2,"ion-title",[],null,null,null,e.Db,e.N)),o.Ab(9,49152,null,0,b.Ab,[o.j,o.p,o.F],null,null),(n()(),o.Tb(-1,0,["Your Bookings"])),(n()(),o.Bb(11,0,null,null,11,"ion-content",[],null,null,null,e.bb,e.l)),o.Ab(12,49152,null,0,b.u,[o.j,o.p,o.F],null,null),(n()(),o.Bb(13,0,null,0,9,"ion-grid",[],null,null,null,e.db,e.n)),o.Ab(14,49152,null,0,b.A,[o.j,o.p,o.F],null,null),(n()(),o.Bb(15,0,null,0,7,"ion-row",[],null,null,null,e.rb,e.B)),o.Ab(16,49152,null,0,b.jb,[o.j,o.p,o.F],null,null),(n()(),o.qb(16777216,null,0,1,null,p)),o.Ab(18,16384,null,0,r.k,[o.W,o.S],{ngIf:[0,"ngIf"]},null),(n()(),o.qb(16777216,null,0,1,null,f)),o.Ab(20,16384,null,0,r.k,[o.W,o.S],{ngIf:[0,"ngIf"]},null),(n()(),o.qb(16777216,null,0,1,null,d)),o.Ab(22,16384,null,0,r.k,[o.W,o.S],{ngIf:[0,"ngIf"]},null)],(function(n,l){var u=l.component;n(l,7,0,"m1"),n(l,18,0,u.isLoading),n(l,20,0,!(u.isLoading||u.loadedBookings&&0!=u.loadedBookings.length)),n(l,22,0,!u.isLoading&&u.loadedBookings&&u.loadedBookings.length>0)}),null)}function k(n){return o.Vb(0,[(n()(),o.Bb(0,0,null,null,1,"app-bookings",[],null,null,null,h,a)),o.Ab(1,245760,null,0,s,[c.a,b.Gb],null,null)],(function(n,l){n(l,1,0)}),null)}var m=o.xb("app-bookings",s,k,{},{},[]),j=u("gIcY"),B=u("ZYCi"),F=function(){return function(){}}();u.d(l,"BookingsPageModuleNgFactory",(function(){return v}));var v=o.yb(t,[],(function(n){return o.Jb([o.Kb(512,o.m,o.jb,[[8,[i.a,m]],[3,o.m],o.D]),o.Kb(4608,r.m,r.l,[o.z,[2,r.s]]),o.Kb(4608,j.u,j.u,[]),o.Kb(4608,b.c,b.c,[o.F,o.g]),o.Kb(4608,b.Ib,b.Ib,[b.c,o.m,o.w]),o.Kb(4608,b.Mb,b.Mb,[b.c,o.m,o.w]),o.Kb(1073742336,r.b,r.b,[]),o.Kb(1073742336,j.t,j.t,[]),o.Kb(1073742336,j.h,j.h,[]),o.Kb(1073742336,b.Eb,b.Eb,[]),o.Kb(1073742336,B.o,B.o,[[2,B.t],[2,B.m]]),o.Kb(1073742336,F,F,[]),o.Kb(1073742336,t,t,[]),o.Kb(1024,B.k,(function(){return[[{path:"",component:s}]]}),[])])}))}}]);